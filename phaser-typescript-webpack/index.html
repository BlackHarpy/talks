<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Configurando un Proyecto Phaser en Typescript y Webpack, por María Castro</title>

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css">
	<link rel="stylesheet" href="css/custom.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<div class="title-container">
					<div>
						<!-- <img class="plain main-logo" src="images/phaser-white.gif">			(Not done yet) -->
						<img class="plain main-logo" src="images/typescript-white.gif">
						<img class="plain main-logo" src="images/webpack-white.gif">
					</div>
					<div>
						<img class="plain title-img" src="images/title.gif">
						<div class="name-container">
							<small>Por María Castro</small>
						</div>
					</div>
				</div>
				<div class="social-logo-container">
					<p>@BlackHarpy</p>
					<a href="https://github.com/BlackHarpy">
						<img class="plain social-logo" src="images/github-white.gif">
					</a>
					<a href="https://twitter.com/BlackHarpy">
						<img class="plain social-logo" src="images/twitter-white.gif">
					</a>
					<a href="https://www.facebook.com/BlackHarpy">
						<img class="plain social-logo" src="images/facebook-white.gif">
					</a>
					<a href="https://www.reddit.com/user/BlackHarpy/">
						<img class="plain social-logo" src="images/reddit-white.gif">
					</a>
				</div>
			</section>
			<section>
				<h3>¿Por qué?</h3>
			</section>
			<section>
				<h2>¿Cómo?</h2>
				<ul>
					<li>Instalar paquetes</li>
					<li>Configuración de TypeScript</li>
					<li>Configuración de Webpack</li>
				</ul>
			</section>
			<section>
				<h2>Instalar paquetes de Node</h2>
				<pre>
						<code class="hljs" data-trim data-noescape>
							<b>$</b> npm install 
							<span class="fragment">      phaser-ce              <span class="hljs-comment"># Duh (Phaser Community Edition)</span></span> 
							<span class="fragment">      typescript             <span class="hljs-comment"># Compilador de TypeScript</span></span>
							<span class="fragment">      webpack                <span class="hljs-comment"># Empaquetador de Módulos</span></span>
							<span class="fragment">         ts-loader              <span class="hljs-comment"># Cargar TypeScript en Webpack</span></span>
							<span class="fragment">         expose-loader          <span class="hljs-comment"># Añadir módulos como objetos globales</span></span>
							<span class="fragment hljs-comment">  # Y el resto: servidor, minificado, manejo de imágenes y css, etc...</span>
					</code>
				</pre>
			</section>
			<section>
				<h2>Configuración de TypeScript</h2>
				<section>
					<pre>
									<div class="hljs-title">./tsconfig.json</div>
										<code class="hljs" data-trim data-noescape>
										
										  {
											    "compilerOptions": {
												      "target": "es6",
												      "module": "commonjs",
												      "outDir": "dist",
												      "sourceMap": true,
												      "typeRoots": [ "./node_modules/@types" ]
											    },
											    "include": ["src/**/*.ts"],
											    "exclude": ["node_modules"]
										  }
									</code>
								</pre>
				</section>
				<section>
					<p>Definición de Tipos para Phaser</p>
					<pre>
											<div class="hljs-title">./src/scripts/app.ts</div>
												<code class="hljs" data-trim>
					/// &lt;reference path="../../node_modules/phaser-ce/typescript/phaser.d.ts"/&gt;
					/// &lt;reference path="../../node_modules/phaser-ce/typescript/pixi.d.ts"/&gt;
											</code>
										</pre>
				</section>
			</section>

			<section>
				<h3>Configuración de Webpack</h3>
				<section>
					<p>Salida del bundle</p>
					<pre>
							<div class="hljs-title">./webpack.config.js</div>
								<code class="hljs javascript" data-trim data-noescape>
									const path = require('path')
									
									module.exports = {
									    devtool: 'inline-source-map',
									    entry: './src/scripts/app.ts',
									    output: {
									        filename: 'app.js',
									        path: path.resolve(__dirname, 'dist')
									    },
									    //...
									}
							</code>
						</pre>
				</section>
				<section>
						<p>Alias para rutas</p>
						<pre>
								<div class="hljs-title">./webpack.config.js</div>
									<code class="hljs javascript" data-trim data-noescape>
											const path = require('path')											
											const phaserModule = path.join(__dirname, '/node_modules/phaser-ce/')
											const phaser = path.join(phaserModule, 'build/custom/phaser-split.js'),
											      pixi = path.join(phaserModule, 'build/custom/pixi.js'),
											      p2 = path.join(phaserModule, 'build/custom/p2.js')
											
											module.exports = {
											    //...
											    resolve: {
											        alias: {
											            'phaser': phaser,
											            'pixi': pixi,
											            'p2': p2,
											            // ... Más alias
											        },
											        extensions: ['.ts', '.tsx', '.js']
											    },
											    //...
											}
								</code>
							</pre>
					</section>
					
				<section>
						<p>Loaders</p>
						<pre>
								<div class="hljs-title">./webpack.config.js</div>
									<code class="hljs javascript" data-trim data-noescape>
										//...															
										module.exports = {
										  //...
										    module: {
										        loaders: [{ test: /\.tsx?$/, loader: 'ts-loader' }, 
										            { test: /pixi\.js/, use: ['expose-loader?PIXI'] },
										            { test: /phaser-split\.js$/, use: ['expose-loader?Phaser'] },
										            { test: /p2\.js/, use: ['expose-loader?p2']},
										            //... Loaders Adicionales
										        ]
										    }
										    //... Configuraciones Adicionales
										}
								</code>
							</pre>
					</section>
			</section>
			<section>
				<h3>Y por último...</h3>
				<pre>
					<div class="hljs-title">./src/scripts/app.ts</div>						
					<code class="hljs typescript">
/// &lt;reference path="../../node_modules/phaser-ce/typescript/phaser.d.ts"/&gt;
/// &lt;reference path="../../node_modules/phaser-ce/typescript/pixi.d.ts"/&gt;

import 'pixi'
import 'p2'
import 'phaser'
							
const logoImage = require('assets/phaser.png')

class SimpleGame {
    game: Phaser.Game;
    constructor() {
        this.game = new Phaser.Game(800, 600, Phaser.AUTO, 'content', { preload: this.preload, create: this.create })
		}
    preload() {
        this.game.load.image('logo', logoImage)
    }
    create() {
        const logo = this.game.add.sprite(this.game.world.centerX, this.game.world.centerY, 'logo')
        const textAlign = {
            font: "15px Arial", 
            fill: "#19de65" ,
            align:  'left',
            boundsAlignH: 'center',
            boundsAlignV: 'bottom'
        }
        const text = this.game.add.text(0, 0, 'Hello World!', textAlign)
        text.setTextBounds(16, 16, 768, 568)
        logo.anchor.setTo(0.5, 0.5)
    }
}

window.onload = () => {
    const game = new SimpleGame()
}
					</code>
				</pre>
			</section>

			<section>

				<h3>¿Y ahora?</h3>

			</section>
			<section>
				¿Ver más?
			</section>

		</div>
	</div>

	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.js"></script>

	<script>
		// More info about config & dependencies:
		// - https://github.com/hakimel/reveal.js#configuration
		// - https://github.com/hakimel/reveal.js#dependencies
		Reveal.initialize({
			display: 'block',
			dependencies: [
				{ src: 'plugin/markdown/marked.js' },
				{ src: 'plugin/markdown/markdown.js' },
				{ src: 'plugin/notes/notes.js', async: true },
				{ src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } }
			]
		});
	</script>
</body>

</html>